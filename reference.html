<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="./content/favicon.ico">
    <link rel="stylesheet" href="./content/main.css" type="text/css" media="all">
    <link rel="stylesheet" href="./content/responsiveslides.css" />
    <title>Baskent Sitesi</title>
</head>
    <body class="single windows reference">
        <div id="container">
            <div class="content">
                <article class="hentry">
                    <header id="article-header" class="entry-header">
                        <a class="logo" href="index.html">
                            <h2>Karasu</h2>
                            <h2>Başkent Sitesi</h2>
                        </a>
                        <div class="header-content">
                            <form parsley-validate>
                                <div class="header-content-position">
                                    <h1>
                                        <span class="prize">10.000</span> TL KAZANABİLİRSİNİZ!
                                    </h1>
                                    <p id="info">
                                        Başkent Sitesi'nde villa sahibi olmak isteyecek dostunuz ya da akrabanız var mı?
                                        Eğer satışla sonuçlanan bir referansta bulunursanız 10.000 TL kazanacaksınız!
                                        Referansta bulunmak için aşağıdaki bölümü doldurup GÖNDER butonuna basınız.
                                    </p>
                                    <p id="form">
                                        <input id="ClientName" type="text" placeholder="Muhtemel Alıcı - İsim Soyad" required />
                                        <input id="ClientPhoneNumber" type="text" placeholder="Muhtemel Alıcı - Telefon Numarası" required />
                                        <input id="PhoneNumber" type="text" placeholder="Aracı Şahıs - İsim Soyad" required />
                                        <input id="Name" type="text" placeholder="Aracı Şahıs - Telefon Numarası" required />
                                    </p>
                                    <p id="successText" class="hide">
                                        Referans'ınız iletilmiştir. Aracı olduğunuz kişi bizimle iletişime geçip
                                        alımı gerçekleştirdiği takdirde sizinle iletişime geçeceğiz. Teşekkürler.
                                    </p>
                                    <a id="refer-people" class="refer-button">Gönder!</a>
                                </div>
                            </form>
                        </div>
                        <div class="gradient"></div>
                    </header>
                </article>
            </div>
        </div>
        <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
        <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/mobileservices/MobileServices.Web-1.1.0.min.js"></script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/parsley.js/1.2.2/parsley.min.js"></script>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script>
        <script type="text/javascript" language="javascript">
            $(function () {
                $("#refer-people").click(function () {
                    // validation
                    $('form').parsley('validate');
                    if ($('form').parsley('isValid') != true)
                        return false;
                
                    startLoading();
                
                    var client = new WindowsAzure.MobileServiceClient("https://baskentsitesi.azure-mobile.net/", "KAMqawJwfJKOwyYMQjDumPEslkNbfl17");

                    var name = $("#Name").val();
                    var phoneNumber = $("#PhoneNumber").val();
                    var clientName = $("#ClientName").val();
                    var clientPhoneNumber = $("#ClientPhoneNumber").val();

                    var reference = { Name: name, PhoneNumber: phoneNumber, ClientName: clientName, ClientPhoneNumber: clientPhoneNumber };
                    client.getTable("References").insert(reference).then(
                        setTimeout(function () {
                            $("#form").addClass("hide");
                            $("#info").addClass("hide");
                            $("#successText").removeClass("hide");
                            $("#refer-people").addClass("hide");

                            stopLoading();
                        }, 2000),
                        function(error) {
                            alert(JSON.parse(error.request.responseText).error);
                        });

                    return false;
                });
                
                $("html").keypress(function (event) {
                    if (event.which == 13) {
                        event.preventDefault();
                        $("#refer-people").click();
                    }
                });

                var ellipsisState = 0;
                var buttonText = "GÖNDERİLİYOR";
                var intervalHandle;
                var startLoading = function () {
                    $("#refer-people").off("click");
                    $("#refer-people").addClass("active");
                    ellipsisAnimationJs();
                    intervalHandle = setInterval(ellipsisAnimationJs, 200);
                };
                var stopLoading = function () {
                    clearInterval(intervalHandle);
                };
                var ellipsisAnimationJs = function() {
                    var currentText = buttonText;
                    for (var i = 0; i < ellipsisState; i++) {
                        currentText += ".";
                    }
                    $("#refer-people").text(currentText);
                
                    if (ellipsisState < 3)
                        ellipsisState++;
                    else
                        ellipsisState = 0;
                };
            });
        </script>
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-48149810-2', 'hakant.github.io');
            ga('send', 'pageview');

        </script>
    </body>
</html>